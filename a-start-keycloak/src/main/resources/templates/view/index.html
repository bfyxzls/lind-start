<!DOCTYPE html>
<html
        xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
        layout:decorator="layout">
<div layout:fragment="content">
    <script>
        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                if (pair[0] == variable) {
                    return pair[1];
                }
            }
            return (false);
        }

        $(function () {
            $.ajax({
                type: "get",
                headers: {"Authorization": "bearer " + getQueryVariable("token")},
                url: "/products",
                statusCode: {
                    401: function () {
                        location.href = "http://localhost:9090/auth/realms/demo/protocol/openid-connect/auth?scope=openid&response_type=code&client_id=democlient&redirect_uri=http://localhost:9090/token/authorizationCodeLogin";
                    },
                    403: function () {
                        alert("403无权访问");
                    },
                    200: function(){
                        alert("正常加载");
                    }
                },
                success: function (data) {
                    $("#data-info").html(data);
                }
            })
        });
    </script>
    <ol class="breadcrumb">
        <li>工作流</li>
        <li>审批历史</li>
    </ol>
    <!--遍历数组-->
    <div id="data-info">
        未加载...
    </div>
</div>
</html>
